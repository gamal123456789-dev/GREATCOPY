# ุฏููู ุญู ูุดููุฉ ุชุณุฌูู ุงูุฏุฎูู ุจุงูุฏูุณููุฑุฏ

## ๐ ูุตู ุงููุดููุฉ
ุนูุฏ ูุญุงููุฉ ุชุณุฌูู ุงูุฏุฎูู ุจุงูุฏูุณููุฑุฏุ ูุชู ุชูุฌูู ุงููุณุชุฎุฏู ุฅูู ุตูุญุฉ Discord OAuth ูููู ุจุนุฏ ุงูููุงููุฉ ุนูู ุงูุตูุงุญูุงุช ูุง ูุชู ุชุณุฌูู ุงูุฏุฎูู ูู ุงููููุน.

## ๐ฏ ุงูุณุจุจ ุงูุฃูุซุฑ ุงุญุชูุงูุงู
ุงููุดููุฉ ุงูุฃุณุงุณูุฉ ูู ุนุฏู ุฅุถุงูุฉ **Redirect URI** ุงูุตุญูุญ ูู Discord Developer Portal.

## ๐ง ุงูุญู ุงูุดุงูู

### 1. ุฅุนุฏุงุฏ Discord Developer Portal

#### ุงูุฎุทูุงุช:
1. ุงุฐูุจ ุฅูู [Discord Developer Portal](https://discord.com/developers/applications)
2. ุงุฎุชุฑ ุชุทุจููู ุจู Client ID: `1389217214409998468`
3. ุงุฐูุจ ุฅูู **OAuth2** > **General**
4. ูู ูุณู **Redirects**ุ ุฃุถู ูุฐู ุงูู URIs:
   ```
   http://localhost:3000/api/auth/callback/discord
   https://gear-score.com/api/auth/callback/discord
   ```
5. ุงุญูุธ ุงูุชุบููุฑุงุช

#### โ๏ธ ููุงุท ูููุฉ:
- ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ูุณุงูุงุช ุฅุถุงููุฉ
- ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ `/` ูู ููุงูุฉ ุงูู URI
- ุงูู URI ุญุณุงุณ ููุฃุญุฑู ุงููุจูุฑุฉ ูุงูุตุบูุฑุฉ

### 2. ุงูุชุญูู ูู ูุชุบูุฑุงุช ุงูุจูุฆุฉ

#### ูู ููู `.env`:
```env
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your-secret-here
DISCORD_CLIENT_ID=1389217214409998468
DISCORD_CLIENT_SECRET=your-discord-secret
```

#### ูู ููู `.env.production`:
```env
NEXTAUTH_URL=https://gear-score.com
NEXTAUTH_SECRET=your-secret-here
DISCORD_CLIENT_ID=1389217214409998468
DISCORD_CLIENT_SECRET=your-discord-secret
```

### 3. ุชูููู ูุถุน ุงูุชุดุฎูุต

ุชู ุชูููู `debug: true` ูู NextAuth config ูุฑุคูุฉ ุงูุฃุฎุทุงุก ุงูุชูุตูููุฉ.

### 4. ุงุฎุชุจุงุฑ ุงูุญู

#### ุงูุทุฑููุฉ ุงูุฃููู - ุงุฎุชุจุงุฑ ูุฏูู:
1. ุงูุณุญ ุฌููุน ุงูููููุฒ ูู ุงููุชุตูุญ
2. ุงุฐูุจ ุฅูู `http://localhost:3000/auth`
3. ุงุถุบุท ุนูู "ุชุณุฌูู ุงูุฏุฎูู ุจุงูุฏูุณููุฑุฏ"
4. ุฑุงูุจ ุณุฌูุงุช ุงูุฎุงุฏู ููุฃุฎุทุงุก

#### ุงูุทุฑููุฉ ุงูุซุงููุฉ - ุงุฎุชุจุงุฑ ูุจุงุดุฑ:
1. ุงูุณุฎ ูุฐุง ุงูุฑุงุจุท:
   ```
   https://discord.com/api/oauth2/authorize?client_id=1389217214409998468&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fapi%2Fauth%2Fcallback%2Fdiscord&response_type=code&scope=identify+email&prompt=consent
   ```
2. ุงูุตูู ูู ุงููุชุตูุญ
3. ุณุฌู ุฏุฎูู ุจุญุณุงุจ Discord
4. ุงูุจู ุงูุตูุงุญูุงุช

### 5. ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ ูุญููููุง

#### ุฎุทุฃ: "Invalid OAuth2 redirect_uri"
**ุงูุญู:** ุชุฃูุฏ ูู ุฅุถุงูุฉ ุงูู Redirect URI ูู Discord Developer Portal

#### ุฎุทุฃ: "Application does not have a bot"
**ุงูุญู:** ูุง ุชุญุชุงุฌ bot ููู OAuthุ ุชุฌุงูู ูุฐุง ุงูุฎุทุฃ

#### ุฎุทุฃ: "Invalid client_secret"
**ุงูุญู:** ุชุญูู ูู `DISCORD_CLIENT_SECRET` ูู ููู `.env`

#### ุงููุณุชุฎุฏู ูุชู ุชูุฌููู ููู ูุง ูุณุฌู ุฏุฎูู
**ุงูุญู:** 
1. ุชุญูู ูู ุณุฌูุงุช ุงูุฎุงุฏู
2. ุชุฃูุฏ ูู ุฃู ุงูุฅูููู ูู Discord ููุนู ููุฑุฆู
3. ุงูุณุญ ุงูููููุฒ ูุญุงูู ูุฑุฉ ุฃุฎุฑู

### 6. ูุญุต ูุงุนุฏุฉ ุงูุจูุงูุงุช

ููุญุต ูุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ุชู ุฅูุดุงุคู:
```bash
node -e "const { PrismaClient } = require('@prisma/client'); const prisma = new PrismaClient(); prisma.user.findMany().then(users => console.log(users)).finally(() => prisma.$disconnect());"
```

### 7. ูููุงุช ุงูุงุฎุชุจุงุฑ ุงููุชุงุญุฉ

- `test-discord-login-debug.js` - ุชุดุฎูุต ุดุงูู
- `test-discord-auth-flow.js` - ูุญุงูุงุฉ ุชุฏูู ุงููุตุงุฏูุฉ
- `test-discord-redirect-url.js` - ุงุฎุชุจุงุฑ URL ุงูุตุญูุญ
- `debug-discord-auth.js` - ุชุดุฎูุต ูุชูุฏู

### 8. ุฎุทูุงุช ุงูุชุญูู ุงูููุงุฆูุฉ

โ **ูุงุฆูุฉ ุงูุชุญูู:**
- [ ] ุชู ุฅุถุงูุฉ Redirect URI ูู Discord Developer Portal
- [ ] ูุชุบูุฑุงุช ุงูุจูุฆุฉ ุตุญูุญุฉ
- [ ] ุชู ุชูููู debug mode
- [ ] ุชู ูุณุญ ุงูููููุฒ ูู ุงููุชุตูุญ
- [ ] ุงูุฎุงุฏู ูุนูู ุนูู `http://localhost:3000`
- [ ] ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู ุณุฌูุงุช ุงูุฎุงุฏู

## ๐ ุจุนุฏ ุชุทุจูู ุงูุญู

1. ุฃุนุฏ ุชุดุบูู ุงูุฎุงุฏู
2. ุงูุณุญ ุงูููููุฒ ูู ุงููุชุตูุญ
3. ุฌุฑุจ ุชุณุฌูู ุงูุฏุฎูู ุจุงูุฏูุณููุฑุฏ
4. ุฑุงูุจ ุณุฌูุงุช ุงูุฎุงุฏู ููุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก

## ๐ ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ

1. ุชุญูู ูู ุณุฌูุงุช ุงูุฎุงุฏู ุฃุซูุงุก ูุญุงููุฉ ุชุณุฌูู ุงูุฏุฎูู
2. ุชุฃูุฏ ูู ุฃู Discord account ูุฏูู ุฅูููู ููุนู
3. ุฌุฑุจ ุญุณุงุจ Discord ูุฎุชูู
4. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุฎุตูุตูุฉ ูู ุญุณุงุจ Discord

---

**ููุงุญุธุฉ:** ุชู ุชูููู debug mode ูู NextAuthุ ูุฐุง ุณุชุธูุฑ ูุนูููุงุช ุชูุตูููุฉ ูู ุณุฌูุงุช ุงูุฎุงุฏู ุฃุซูุงุก ุนูููุฉ ุชุณุฌูู ุงูุฏุฎูู.